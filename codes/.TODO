follow the MPU code to create dgnodes_ed in a better way (or the same way if MPU's way is good)
